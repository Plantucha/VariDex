============================= test session starts ==============================
platform linux -- Python 3.13.7, pytest-9.0.2, pluggy-1.6.0
rootdir: /media/michal/647A504F7A50205A/GENOME/Michal/VariDex10/VariDex
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
testpaths: tests
plugins: cov-7.0.0, typeguard-4.4.4, hypothesis-6.151.3
collected 921 items

tests/annotation/test_annotator.py ..................................... [  4%]
........................................................................ [ 11%]
...........                                                              [ 13%]
tests/reporting/test_cli.py .FFFF..                                      [ 13%]
tests/reporting/test_core.py ...........                                 [ 14%]
tests/reporting/test_integration.py .....                                [ 15%]
tests/test_acmg_classification.py ............................           [ 18%]
tests/test_cli_interface.py FFF....F...F..FFFFFFFFF.FFFF                 [ 21%]
tests/test_core_config.py ..................................             [ 25%]
tests/test_core_models.py .FFFFFFFF.F....F..FFFF...........              [ 28%]
tests/test_coverage_boost_error_handlers.py ............................ [ 31%]
.....................                                                    [ 34%]
tests/test_coverage_boost_integration_paths.py ..........F.............. [ 36%]
.................                                                        [ 38%]
tests/test_coverage_boost_validation.py .....FF......F.................. [ 42%]
...................                                                      [ 44%]
tests/test_coverage_gaps.py ss..s.s..sssssssFF                           [ 46%]
tests/test_data_validation.py ...F...F...........F......F..F....         [ 49%]
tests/test_dbnsfp_integration.py .............................           [ 53%]
tests/test_downloader.py .......FFFFFFFFFFFFFFFF                         [ 55%]
tests/test_edge_cases.py .............F.....................FF           [ 59%]
tests/test_error_recovery.py .............F.................             [ 62%]
tests/test_exceptions.py ...............                                 [ 64%]
tests/test_gnomad_integration.py ...............................         [ 67%]
tests/test_integration_e2e.py FFF..FFFFFFFF.FF                           [ 69%]
tests/test_io_matching.py ....F.FFF.FFFFFFFFFFFFFF                       [ 72%]
tests/test_performance_benchmarks.py ....F....F..                        [ 73%]
tests/test_pipeline.py ...........................................       [ 78%]
tests/test_pipeline_orchestrator.py ........FF.F....FFF.......           [ 81%]
tests/test_pipeline_stages.py FFFFFFFFFFFFFFFFFFFFFFFFFFFFFF             [ 84%]
tests/test_pipeline_validators.py .........................FF..........F [ 88%]
...F                                                                     [ 88%]
tests/test_property_based.py .................................           [ 92%]
tests/test_reports_generator.py .FFFFFFFFFFFFFF.FFFFF.EEEEFsss           [ 95%]
tests/test_utils_helpers.py ........................F..............      [100%]

==================================== ERRORS ====================================
_______ ERROR at setup of TestReportStatistics.test_count_by_chromosome ________
varidex/core/models.py:174: in _validate_position
    pos_int = int(pos_str)
              ^^^^^^^^^^^^
E   ValueError: invalid literal for int() with base 10: 'A'

The above exception was the direct cause of the following exception:
varidex/core/models.py:335: in __init__
    position = _validate_position(position)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:180: in _validate_position
    raise ValidationError(
E   varidex.exceptions.ValidationError: Position must be an integer, got 'A'

The above exception was the direct cause of the following exception:
tests/test_reports_generator.py:347: in sample_variants
    Variant(
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Position must be an integer, got 'A'
_________ ERROR at setup of TestReportStatistics.test_count_by_impact __________
varidex/core/models.py:174: in _validate_position
    pos_int = int(pos_str)
              ^^^^^^^^^^^^
E   ValueError: invalid literal for int() with base 10: 'A'

The above exception was the direct cause of the following exception:
varidex/core/models.py:335: in __init__
    position = _validate_position(position)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:180: in _validate_position
    raise ValidationError(
E   varidex.exceptions.ValidationError: Position must be an integer, got 'A'

The above exception was the direct cause of the following exception:
tests/test_reports_generator.py:347: in sample_variants
    Variant(
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Position must be an integer, got 'A'
__________ ERROR at setup of TestReportStatistics.test_count_by_gene ___________
varidex/core/models.py:174: in _validate_position
    pos_int = int(pos_str)
              ^^^^^^^^^^^^
E   ValueError: invalid literal for int() with base 10: 'A'

The above exception was the direct cause of the following exception:
varidex/core/models.py:335: in __init__
    position = _validate_position(position)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:180: in _validate_position
    raise ValidationError(
E   varidex.exceptions.ValidationError: Position must be an integer, got 'A'

The above exception was the direct cause of the following exception:
tests/test_reports_generator.py:347: in sample_variants
    Variant(
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Position must be an integer, got 'A'
_______ ERROR at setup of TestReportStatistics.test_total_variant_count ________
varidex/core/models.py:174: in _validate_position
    pos_int = int(pos_str)
              ^^^^^^^^^^^^
E   ValueError: invalid literal for int() with base 10: 'A'

The above exception was the direct cause of the following exception:
varidex/core/models.py:335: in __init__
    position = _validate_position(position)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:180: in _validate_position
    raise ValidationError(
E   varidex.exceptions.ValidationError: Position must be an integer, got 'A'

The above exception was the direct cause of the following exception:
tests/test_reports_generator.py:347: in sample_variants
    Variant(
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Position must be an integer, got 'A'
=================================== FAILURES ===================================
_________________ TestReportingCLI.test_single_format[--html] __________________
tests/reporting/test_cli.py:22: in test_single_format
    assert result.exit_code == 0  # Mock success
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: assert 1 == 0
E    +  where 1 = <Result IsADirectoryError(21, 'Is a directory')>.exit_code
__________________ TestReportingCLI.test_single_format[--tsv] __________________
tests/reporting/test_cli.py:22: in test_single_format
    assert result.exit_code == 0  # Mock success
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: assert 1 == 0
E    +  where 1 = <Result IsADirectoryError(21, 'Is a directory')>.exit_code
_________________ TestReportingCLI.test_single_format[--json] __________________
tests/reporting/test_cli.py:22: in test_single_format
    assert result.exit_code == 0  # Mock success
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: assert 1 == 0
E    +  where 1 = <Result IsADirectoryError(21, 'Is a directory')>.exit_code
__________________ TestReportingCLI.test_single_format[--qc] ___________________
tests/reporting/test_cli.py:22: in test_single_format
    assert result.exit_code == 0  # Mock success
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: assert 1 == 0
E    +  where 1 = <Result IsADirectoryError(21, 'Is a directory')>.exit_code
_____________________ TestCLIArguments.test_cli_help_flag ______________________
tests/test_cli_interface.py:16: in test_cli_help_flag
    with pytest.raises(SystemExit) as exc:
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'SystemExit'>
____________________ TestCLIArguments.test_cli_version_flag ____________________
tests/test_cli_interface.py:25: in test_cli_version_flag
    with pytest.raises(SystemExit) as exc:
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'SystemExit'>
___________________ TestCLIArguments.test_cli_required_args ____________________
tests/test_cli_interface.py:32: in test_cli_required_args
    with pytest.raises(SystemExit):
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'SystemExit'>
____________ TestCLIFileValidation.test_cli_input_file_permissions _____________
tests/test_cli_interface.py:82: in test_cli_input_file_permissions
    with pytest.raises(PermissionError):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'PermissionError'>
____________________ TestCLIExecution.test_cli_verbose_mode ____________________
tests/test_cli_interface.py:121: in test_cli_verbose_mode
    assert "Processing" in captured.out or "Loading" in captured.out
E   AssertionError: assert ('Processing' in '' or 'Loading' in '')
E    +  where '' = CaptureResult(out='', err='').out
E    +  and   '' = CaptureResult(out='', err='').out
______________ TestCLIErrorHandling.test_cli_missing_input_error _______________
tests/test_cli_interface.py:147: in test_cli_missing_input_error
    with pytest.raises(SystemExit) as exc:
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'SystemExit'>
______________ TestCLIErrorHandling.test_cli_invalid_format_error ______________
tests/test_cli_interface.py:157: in test_cli_invalid_format_error
    with pytest.raises(SystemExit) as exc:
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'SystemExit'>
________________ TestCLIErrorHandling.test_cli_permission_error ________________
tests/test_cli_interface.py:168: in test_cli_permission_error
    with pytest.raises(SystemExit) as exc:
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'SystemExit'>
_______________ TestCLIErrorHandling.test_cli_interrupt_handling _______________
tests/test_cli_interface.py:178: in test_cli_interrupt_handling
    with pytest.raises(SystemExit) as exc:
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'SystemExit'>
___________________ TestCLIOutputFormats.test_cli_csv_output ___________________
tests/test_cli_interface.py:190: in test_cli_csv_output
    assert output_file.exists()
E   AssertionError: assert False
E    +  where False = exists()
E    +    where exists = PosixPath('/tmp/pytest-of-michal/pytest-46/test_cli_csv_output0/output.csv').exists
__________________ TestCLIOutputFormats.test_cli_json_output ___________________
tests/test_cli_interface.py:197: in test_cli_json_output
    assert output_file.exists()
E   AssertionError: assert False
E    +  where False = exists()
E    +    where exists = PosixPath('/tmp/pytest-of-michal/pytest-46/test_cli_json_output0/output.json').exists
___________________ TestCLIOutputFormats.test_cli_vcf_output ___________________
tests/test_cli_interface.py:204: in test_cli_vcf_output
    assert output_file.exists()
E   AssertionError: assert False
E    +  where False = exists()
E    +    where exists = PosixPath('/tmp/pytest-of-michal/pytest-46/test_cli_vcf_output0/output.vcf').exists
_____________ TestCLIOutputFormats.test_cli_auto_format_detection ______________
tests/test_cli_interface.py:213: in test_cli_auto_format_detection
    assert output_csv.exists()
E   AssertionError: assert False
E    +  where False = exists()
E    +    where exists = PosixPath('/tmp/pytest-of-michal/pytest-46/test_cli_auto_format_detection0/output.csv').exists
___________ TestCLIConfigurationOptions.test_cli_config_file_loading ___________
tests/test_cli_interface.py:231: in test_cli_config_file_loading
    config = load_config(str(config_file))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_cli_interface.py:332: in load_config
    import yaml
E   ModuleNotFoundError: No module named 'yaml'
___________ TestCLIConfigurationOptions.test_cli_invalid_config_file ___________
tests/test_cli_interface.py:249: in test_cli_invalid_config_file
    with pytest.raises(SystemExit) as exc:
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'SystemExit'>
________________ TestCLIProgressReporting.test_cli_progress_bar ________________
tests/test_cli_interface.py:264: in test_cli_progress_bar
    assert "%" in captured.out or "Progress" in captured.out
E   AssertionError: assert ('%' in '' or 'Progress' in '')
E    +  where '' = CaptureResult(out='', err='').out
E    +  and   '' = CaptureResult(out='', err='').out
_____________ TestCLIProgressReporting.test_cli_log_file_creation ______________
tests/test_cli_interface.py:270: in test_cli_log_file_creation
    assert log_file.exists()
E   AssertionError: assert False
E    +  where False = exists()
E    +    where exists = PosixPath('/tmp/pytest-of-michal/pytest-46/test_cli_log_file_creation0/varidex.log').exists
_________________ TestCLIProgressReporting.test_cli_log_level __________________
tests/test_cli_interface.py:276: in test_cli_log_level
    content = log_file.read_text()
              ^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/pathlib/_local.py:548: in read_text
    return PathBase.read_text(self, encoding, errors, newline)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/pathlib/_abc.py:632: in read_text
    with self.open(mode='r', encoding=encoding, errors=errors, newline=newline) as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/pathlib/_local.py:539: in open
    return io.open(self, mode, buffering, encoding, errors, newline)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   FileNotFoundError: [Errno 2] No such file or directory: '/tmp/pytest-of-michal/pytest-46/test_cli_log_level0/debug.log'
________________ TestVariantCreation.test_full_variant_creation ________________
tests/test_core_models.py:53: in test_full_variant_creation
    assert variant.rs_id == "rs11540652"
           ^^^^^^^^^^^^^
E   AttributeError: 'VariantData' object has no attribute 'rs_id'. Did you mean: 'rsid'?
____________ TestVariantCreation.test_variant_with_optional_fields _____________
tests/test_core_models.py:67: in test_variant_with_optional_fields
    assert variant.consequence == "missense_variant"
E   AssertionError: assert '' == 'missense_variant'
E     
E     - missense_variant
________________ TestVariantValidation.test_invalid_chromosome _________________
tests/test_core_models.py:77: in test_invalid_chromosome
    with pytest.raises((ValidationError, ValueError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'varidex.core.exceptions.ValidationError'>, <class 'ValueError'>)
_________________ TestVariantValidation.test_negative_position _________________
varidex/core/models.py:335: in __init__
    position = _validate_position(position)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:176: in _validate_position
    raise ValidationError(f"Position must be positive, got {pos_int}")
E   varidex.exceptions.ValidationError: Position must be positive, got -100

The above exception was the direct cause of the following exception:
tests/test_core_models.py:83: in test_negative_position
    Variant(chrom="chr1", pos=-100, ref="A", alt="G")
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Position must be positive, got -100
___________________ TestVariantValidation.test_zero_position ___________________
varidex/core/models.py:335: in __init__
    position = _validate_position(position)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:176: in _validate_position
    raise ValidationError(f"Position must be positive, got {pos_int}")
E   varidex.exceptions.ValidationError: Position must be positive, got 0

The above exception was the direct cause of the following exception:
tests/test_core_models.py:88: in test_zero_position
    Variant(chrom="chr1", pos=0, ref="A", alt="G")
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Position must be positive, got 0
_________________ TestVariantValidation.test_empty_ref_allele __________________
varidex/core/models.py:336: in __init__
    ref_allele = _validate_allele(
varidex/core/models.py:215: in _validate_allele
    raise ValidationError(f"{allele_type.capitalize()} cannot be empty")
E   varidex.exceptions.ValidationError: Reference allele cannot be empty

The above exception was the direct cause of the following exception:
tests/test_core_models.py:93: in test_empty_ref_allele
    Variant(chrom="chr1", pos=100, ref="", alt="G")
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Reference allele cannot be empty
_________________ TestVariantValidation.test_empty_alt_allele __________________
varidex/core/models.py:339: in __init__
    alt_allele = _validate_allele(
varidex/core/models.py:215: in _validate_allele
    raise ValidationError(f"{allele_type.capitalize()} cannot be empty")
E   varidex.exceptions.ValidationError: Alternate allele cannot be empty

The above exception was the direct cause of the following exception:
tests/test_core_models.py:98: in test_empty_alt_allele
    Variant(chrom="chr1", pos=100, ref="A", alt="")
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Alternate allele cannot be empty
________________ TestVariantValidation.test_invalid_nucleotides ________________
varidex/core/models.py:336: in __init__
    ref_allele = _validate_allele(
varidex/core/models.py:223: in _validate_allele
    raise ValidationError(
E   varidex.exceptions.ValidationError: Invalid reference allele 'X'. Must contain only nucleotides A, C, G, T, or N

The above exception was the direct cause of the following exception:
tests/test_core_models.py:103: in test_invalid_nucleotides
    Variant(chrom="chr1", pos=100, ref="X", alt="G")
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Invalid reference allele 'X'. Must contain only nucleotides A, C, G, T, or N
_______________ TestVariantIdentifier.test_variant_id_generation _______________
tests/test_core_models.py:122: in test_variant_id_generation
    assert variant.variant_id == expected_id
E   AssertionError: assert 'chr1:12345:A:G' == 'chr1:12345:A>G'
E     
E     - chr1:12345:A>G
E     ?             ^
E     + chr1:12345:A:G
E     ?             ^
____________ TestVariantSerialization.test_round_trip_serialization ____________
tests/test_core_models.py:187: in test_round_trip_serialization
    assert original.quality_score == restored.quality_score
           ^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'VariantData' object has no attribute 'quality_score'
_______________ TestVariantClassification.test_confidence_range ________________
tests/test_core_models.py:226: in test_confidence_range
    with pytest.raises((ValidationError, ValueError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'varidex.core.exceptions.ValidationError'>, <class 'ValueError'>)
_____________ TestAnnotatedVariant.test_annotated_variant_creation _____________
tests/test_core_models.py:250: in test_annotated_variant_creation
    assert annotated.chrom == "chr1"
           ^^^^^^^^^^^^^^^
E   AttributeError: 'AnnotatedVariant' object has no attribute 'chrom'
__________________ TestAnnotatedVariant.test_gnomad_af_range ___________________
tests/test_core_models.py:261: in test_gnomad_af_range
    assert 0 <= annotated.gnomad_af <= 1.0
                ^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'AnnotatedVariant' object has no attribute 'gnomad_af'
__________________ TestAnnotatedVariant.test_cadd_score_range __________________
tests/test_core_models.py:268: in test_cadd_score_range
    assert annotated.cadd_score >= 0
           ^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'AnnotatedVariant' object has no attribute 'cadd_score'
______________ TestFileReadingEdgeCases.test_very_large_file_size ______________
tests/test_coverage_boost_integration_paths.py:108: in test_very_large_file_size
    assert large_file.stat().st_size > 100000
E   AssertionError: assert 98890 > 100000
E    +  where 98890 = os.stat_result(st_mode=33204, st_ino=69444, st_dev=49, st_nlink=1, st_uid=1000, st_gid=1000, st_size=98890, st_atime=1769645099, st_mtime=1769645099, st_ctime=1769645099).st_size
E    +    where os.stat_result(st_mode=33204, st_ino=69444, st_dev=49, st_nlink=1, st_uid=1000, st_gid=1000, st_size=98890, st_atime=1769645099, st_mtime=1769645099, st_ctime=1769645099) = stat()
E    +      where stat = PosixPath('/tmp/pytest-of-michal/pytest-46/test_very_large_file_size0/large.txt').stat
____________ TestChromosomeValidation.test_invalid_chromosome_names ____________
tests/test_coverage_boost_validation.py:77: in test_invalid_chromosome_names
    with pytest.raises((ValidationError, ValueError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'varidex.exceptions.ValidationError'>, <class 'ValueError'>)
_______ TestChromosomeValidation.test_chromosome_with_special_characters _______
tests/test_coverage_boost_validation.py:84: in test_chromosome_with_special_characters
    with pytest.raises((ValidationError, ValueError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'varidex.exceptions.ValidationError'>, <class 'ValueError'>)
_____________ TestPositionValidation.test_position_string_rejected _____________
tests/test_coverage_boost_validation.py:127: in test_position_string_rejected
    with pytest.raises((ValidationError, TypeError, ValueError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'varidex.exceptions.ValidationError'>, <class 'TypeError'>, <class 'ValueError'>)
____________ TestDownloaderCoverage.test_download_with_invalid_url _____________
tests/test_coverage_gaps.py:402: in test_download_with_invalid_url
    with pytest.raises((ValueError, Exception)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'ValueError'>, <class 'Exception'>)
----------------------------- Captured stdout call -----------------------------

  Security Error: Invalid URL scheme ''. Only HTTPS/HTTP URLs are allowed.
______________ TestDownloaderCoverage.test_download_with_timeout _______________
tests/test_coverage_gaps.py:416: in test_download_with_timeout
    with pytest.raises((requests.exceptions.Timeout, Exception)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'requests.exceptions.Timeout'>, <class 'Exception'>)
----------------------------- Captured stdout call -----------------------------
  URL: http://example.com/file.txt

  Error: HTTP Error 404: Not Found
_______________ TestVariantDataValidation.test_invalid_positions _______________
tests/test_data_validation.py:46: in test_invalid_positions
    with pytest.raises(ValueError):
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'ValueError'>
________________ TestFrequencyValidation.test_valid_frequencies ________________
tests/test_data_validation.py:86: in test_valid_frequencies
    assert validate_frequency(freq)
E   assert 0.0
E    +  where 0.0 = validate_frequency(0.0)
_______________ TestDataFrameValidation.test_duplicate_variants ________________
tests/test_data_validation.py:187: in test_duplicate_variants
    assert len(duplicates) == 1  # One duplicate pair
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert 2 == 1
E    +  where 2 = len(  CHROM  POS REF ALT\n0     1  100   A   T\n1     1  100   A   T)
______________ TestBoundaryConditions.test_max_chromosome_length _______________
tests/test_data_validation.py:245: in test_max_chromosome_length
    with pytest.raises(ValueError):
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'ValueError'>
_______________ TestBoundaryConditions.test_extreme_float_values _______________
tests/test_data_validation.py:265: in test_extreme_float_values
    with pytest.raises(ValueError):
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'ValueError'>
_________________ TestDownloadFile.test_download_file_success __________________
/usr/lib/python3.13/unittest/mock.py:1423: in patched
    with self.decoration_helper(patched,
/usr/lib/python3.13/contextlib.py:141: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1405: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/contextlib.py:530: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1481: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.13/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'varidex.downloader' has no attribute 'requests'
________________ TestDownloadFile.test_download_file_http_error ________________
/usr/lib/python3.13/unittest/mock.py:1423: in patched
    with self.decoration_helper(patched,
/usr/lib/python3.13/contextlib.py:141: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1405: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/contextlib.py:530: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1481: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.13/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'varidex.downloader' has no attribute 'requests'
______________ TestDownloadFile.test_download_file_with_progress _______________
/usr/lib/python3.13/unittest/mock.py:1423: in patched
    with self.decoration_helper(patched,
/usr/lib/python3.13/contextlib.py:141: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1405: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/contextlib.py:530: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1481: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.13/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'varidex.downloader' has no attribute 'requests'
______________ TestDownloadFile.test_download_file_network_error _______________
/usr/lib/python3.13/unittest/mock.py:1423: in patched
    with self.decoration_helper(patched,
/usr/lib/python3.13/contextlib.py:141: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1405: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/contextlib.py:530: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1481: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.13/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'varidex.downloader' has no attribute 'requests'
______________ TestResourceDownloader.test_init_default_cache_dir ______________
tests/test_downloader.py:166: in test_init_default_cache_dir
    assert downloader.cache_dir is not None
           ^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ResourceDownloader' object has no attribute 'cache_dir'
______________ TestResourceDownloader.test_init_custom_cache_dir _______________
tests/test_downloader.py:172: in test_init_custom_cache_dir
    downloader = ResourceDownloader(cache_dir=cache_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ResourceDownloader.__init__() got an unexpected keyword argument 'cache_dir'
___________ TestResourceDownloader.test_download_resource_not_cached ___________
tests/test_downloader.py:182: in test_download_resource_not_cached
    downloader = ResourceDownloader(cache_dir=cache_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ResourceDownloader.__init__() got an unexpected keyword argument 'cache_dir'
_________ TestResourceDownloader.test_download_resource_already_cached _________
tests/test_downloader.py:205: in test_download_resource_already_cached
    downloader = ResourceDownloader(cache_dir=cache_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ResourceDownloader.__init__() got an unexpected keyword argument 'cache_dir'
_________ TestResourceDownloader.test_download_resource_with_checksum __________
tests/test_downloader.py:221: in test_download_resource_with_checksum
    downloader = ResourceDownloader(cache_dir=cache_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ResourceDownloader.__init__() got an unexpected keyword argument 'cache_dir'
_______ TestResourceDownloader.test_download_resource_checksum_mismatch ________
tests/test_downloader.py:246: in test_download_resource_checksum_mismatch
    downloader = ResourceDownloader(cache_dir=cache_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ResourceDownloader.__init__() got an unexpected keyword argument 'cache_dir'
________ TestResourceDownloader.test_download_resource_force_redownload ________
tests/test_downloader.py:269: in test_download_resource_force_redownload
    downloader = ResourceDownloader(cache_dir=cache_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ResourceDownloader.__init__() got an unexpected keyword argument 'cache_dir'
___________________ TestResourceDownloader.test_clear_cache ____________________
tests/test_downloader.py:292: in test_clear_cache
    downloader = ResourceDownloader(cache_dir=cache_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ResourceDownloader.__init__() got an unexpected keyword argument 'cache_dir'
__________________ TestResourceDownloader.test_get_cache_size __________________
tests/test_downloader.py:304: in test_get_cache_size
    downloader = ResourceDownloader(cache_dir=cache_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ResourceDownloader.__init__() got an unexpected keyword argument 'cache_dir'
________________ TestResourceDownloader.test_list_cached_files _________________
tests/test_downloader.py:318: in test_list_cached_files
    downloader = ResourceDownloader(cache_dir=cache_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ResourceDownloader.__init__() got an unexpected keyword argument 'cache_dir'
_______ TestDownloadRetry.test_download_retry_success_on_second_attempt ________
/usr/lib/python3.13/unittest/mock.py:1423: in patched
    with self.decoration_helper(patched,
/usr/lib/python3.13/contextlib.py:141: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1405: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/contextlib.py:530: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1481: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.13/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'varidex.downloader' has no attribute 'requests'
_______________ TestDownloadRetry.test_download_retry_exhausted ________________
/usr/lib/python3.13/unittest/mock.py:1423: in patched
    with self.decoration_helper(patched,
/usr/lib/python3.13/contextlib.py:141: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1405: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/contextlib.py:530: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1481: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.13/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'varidex.downloader' has no attribute 'requests'
_________________ TestMalformedData.test_mixed_type_chromosome _________________
tests/test_edge_cases.py:171: in test_mixed_type_chromosome
    assert df["CHROM"].dtype == object
E   AssertionError: assert <StringDtype(storage='python', na_value=nan)> == object
E    +  where <StringDtype(storage='python', na_value=nan)> = 0     1\n1     2\n2     X\n3     Y\n4    MT\nName: CHROM, dtype: str.dtype
__________ TestDataTypeConversions.test_string_to_numeric_conversion ___________
tests/test_edge_cases.py:401: in test_string_to_numeric_conversion
    assert isinstance(df["POS"][0], (int, float))
E   AssertionError: assert False
E    +  where False = isinstance(np.int64(12345), (<class 'int'>, <class 'float'>))
__________ TestDataTypeConversions.test_numeric_to_string_conversion ___________
tests/test_edge_cases.py:408: in test_numeric_to_string_conversion
    assert df["CHROM"].dtype == object
E   AssertionError: assert <StringDtype(storage='python', na_value=nan)> == object
E    +  where <StringDtype(storage='python', na_value=nan)> = 0    1\n1    2\n2    3\nName: CHROM, dtype: str.dtype
____________ TestDataValidationErrors.test_invalid_position_format _____________
tests/test_error_recovery.py:194: in test_invalid_position_format
    with pytest.raises(ValueError):
         ^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'ValueError'>
___________ TestEndToEndPipeline.test_e2e_single_variant_annotation ____________
tests/test_integration_e2e.py:35: in test_e2e_single_variant_annotation
    from varidex.io.loaders.vcf_loader import load_vcf
E   ModuleNotFoundError: No module named 'varidex.io.loaders.vcf_loader'
___________ TestEndToEndPipeline.test_e2e_variant_matching_workflow ____________
tests/test_integration_e2e.py:73: in test_e2e_variant_matching_workflow
    assert len(matches) == 1
E   assert 0 == 1
E    +  where 0 = len(Empty DataFrame\nColumns: []\nIndex: [])
------------------------------ Captured log call -------------------------------
WARNING  varidex.io.matching:matching.py:85 User DataFrame missing coordinate columns
____________ TestEndToEndPipeline.test_e2e_multi_source_integration ____________
tests/test_integration_e2e.py:87: in test_e2e_multi_source_integration
    from varidex.io.loaders.vcf_loader import load_vcf
E   ModuleNotFoundError: No module named 'varidex.io.loaders.vcf_loader'
_____________ TestPerformanceIntegration.test_large_vcf_processing _____________
tests/test_integration_e2e.py:195: in test_large_vcf_processing
    from varidex.io.loaders.vcf_loader import load_vcf
E   ModuleNotFoundError: No module named 'varidex.io.loaders.vcf_loader'
_______ TestPerformanceIntegration.test_concurrent_matching_performance ________
tests/test_integration_e2e.py:228: in test_concurrent_matching_performance
    assert len(matches) == n_variants // 2
E   assert 0 == (50000 // 2)
E    +  where 0 = len(Empty DataFrame\nColumns: []\nIndex: [])
------------------------------ Captured log call -------------------------------
WARNING  varidex.io.matching:matching.py:85 User DataFrame missing coordinate columns
_________ TestPerformanceIntegration.test_memory_efficient_processing __________
tests/test_integration_e2e.py:245: in test_memory_efficient_processing
    from varidex.io.loaders.vcf_loader import load_vcf_chunked
E   ModuleNotFoundError: No module named 'varidex.io.loaders.vcf_loader'
______________ TestDataIntegrity.test_roundtrip_vcf_to_dataframe _______________
tests/test_integration_e2e.py:270: in test_roundtrip_vcf_to_dataframe
    from varidex.io.loaders.vcf_loader import load_vcf
E   ModuleNotFoundError: No module named 'varidex.io.loaders.vcf_loader'
_____________ TestDataIntegrity.test_coordinate_system_consistency _____________
tests/test_integration_e2e.py:298: in test_coordinate_system_consistency
    from varidex.utils.coordinates import convert_to_1based
E   ModuleNotFoundError: No module named 'varidex.utils.coordinates'
____________ TestDataIntegrity.test_allele_normalization_integrity _____________
tests/test_integration_e2e.py:322: in test_allele_normalization_integrity
    from varidex.io.normalization import normalize_alleles
E   ImportError: cannot import name 'normalize_alleles' from 'varidex.io.normalization' (/media/michal/647A504F7A50205A/GENOME/Michal/VariDex10/VariDex/varidex/io/normalization.py)
___________ TestErrorRecovery.test_pipeline_handles_malformed_input ____________
tests/test_integration_e2e.py:342: in test_pipeline_handles_malformed_input
    from varidex.io.loaders.vcf_loader import load_vcf
E   ModuleNotFoundError: No module named 'varidex.io.loaders.vcf_loader'
____________ TestErrorRecovery.test_pipeline_handles_missing_files _____________
tests/test_integration_e2e.py:349: in test_pipeline_handles_missing_files
    from varidex.io.loaders.vcf_loader import load_vcf
E   ModuleNotFoundError: No module named 'varidex.io.loaders.vcf_loader'
______ TestConfigurationIntegration.test_config_affects_pipeline_behavior ______
tests/test_integration_e2e.py:388: in test_config_affects_pipeline_behavior
    assert config.output_dir == tmp_path
E   AssertionError: assert '/tmp/pytest-of-michal/pytest-46/test_config_affects_pipeline_b0' == PosixPath('/tmp/pytest-of-michal/pytest-46/test_config_affects_pipeline_b0')
E    +  where '/tmp/pytest-of-michal/pytest-46/test_config_affects_pipeline_b0' = VariDexConfig(reference_genome='GRCh38', min_quality_score=20.0, min_read_depth=10, max_missing_rate=0.1, population_a...', include_annotations=True, acmg_strict_mode=False, require_population_data=False, log_level='INFO', debug_mode=False).output_dir
_____________ TestConfigurationIntegration.test_config_persistence _____________
tests/test_integration_e2e.py:406: in test_config_persistence
    assert loaded_config.output_dir == tmp_path
E   AssertionError: assert '/tmp/pytest-of-michal/pytest-46/test_config_persistence0' == PosixPath('/tmp/pytest-of-michal/pytest-46/test_config_persistence0')
E    +  where '/tmp/pytest-of-michal/pytest-46/test_config_persistence0' = VariDexConfig(reference_genome='GRCh38', min_quality_score=20.0, min_read_depth=10, max_missing_rate=0.1, population_a...', include_annotations=True, acmg_strict_mode=False, require_population_data=False, log_level='INFO', debug_mode=False).output_dir
____________ TestMatchByCoordinates.test_match_by_coordinates_exact ____________
tests/test_io_matching.py:77: in test_match_by_coordinates_exact
    assert len(result) == 2
E   assert 0 == 2
E    +  where 0 = len(Empty DataFrame\nColumns: []\nIndex: [])
------------------------------ Captured log call -------------------------------
WARNING  varidex.io.matching:matching.py:85 User DataFrame missing coordinate columns
_______ TestMatchByCoordinates.test_match_by_coordinates_partial_overlap _______
tests/test_io_matching.py:125: in test_match_by_coordinates_partial_overlap
    assert len(result) == 2
E   assert 0 == 2
E    +  where 0 = len(Empty DataFrame\nColumns: []\nIndex: [])
------------------------------ Captured log call -------------------------------
WARNING  varidex.io.matching:matching.py:85 User DataFrame missing coordinate columns
_______ TestMatchByCoordinates.test_match_by_coordinates_allow_mismatch ________
tests/test_io_matching.py:149: in test_match_by_coordinates_allow_mismatch
    result = match_by_coordinates(query_df, ref_df, match_alleles=False)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: match_by_coordinates() got an unexpected keyword argument 'match_alleles'
______________ TestMatchByVariantID.test_match_by_variant_id_rsid ______________
tests/test_io_matching.py:169: in test_match_by_variant_id_rsid
    result = match_by_variant_id(query_df, ref_df)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/io/matching.py:271: in match_by_variant_id
    raise MatchingError(f"Column '{id_column}' not found in user variants")
          ^^^^^^^^^^^^^
E   NameError: name 'MatchingError' is not defined
___________ TestMatchByVariantID.test_match_by_variant_id_no_matches ___________
tests/test_io_matching.py:188: in test_match_by_variant_id_no_matches
    result = match_by_variant_id(query_df, ref_df)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/io/matching.py:271: in match_by_variant_id
    raise MatchingError(f"Column '{id_column}' not found in user variants")
          ^^^^^^^^^^^^^
E   NameError: name 'MatchingError' is not defined
______________ TestFindExactMatches.test_find_exact_matches_basic ______________
tests/test_io_matching.py:224: in test_find_exact_matches_basic
    matches = find_exact_matches(query_variants, reference_variants)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/io/matching.py:359: in find_exact_matches
    matched = variants_df.merge(reference_df, on=match_cols, how="inner")
              ^^^^^^^^^^^^^^^^^
E   AttributeError: 'list' object has no attribute 'merge'
______________ TestFindExactMatches.test_find_exact_matches_none _______________
tests/test_io_matching.py:250: in test_find_exact_matches_none
    matches = find_exact_matches(query_variants, reference_variants)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/io/matching.py:359: in find_exact_matches
    matched = variants_df.merge(reference_df, on=match_cols, how="inner")
              ^^^^^^^^^^^^^^^^^
E   AttributeError: 'list' object has no attribute 'merge'
________ TestFindExactMatches.test_find_exact_matches_assembly_mismatch ________
tests/test_io_matching.py:275: in test_find_exact_matches_assembly_mismatch
    matches = find_exact_matches(query_variants, reference_variants)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/io/matching.py:359: in find_exact_matches
    matched = variants_df.merge(reference_df, on=match_cols, how="inner")
              ^^^^^^^^^^^^^^^^^
E   AttributeError: 'list' object has no attribute 'merge'
_________ TestFindFuzzyMatches.test_find_fuzzy_matches_nearby_position _________
tests/test_io_matching.py:305: in test_find_fuzzy_matches_nearby_position
    matches = find_fuzzy_matches(
E   TypeError: find_fuzzy_matches() got an unexpected keyword argument 'position_tolerance'
________ TestFindFuzzyMatches.test_find_fuzzy_matches_different_alleles ________
tests/test_io_matching.py:332: in test_find_fuzzy_matches_different_alleles
    matches = find_fuzzy_matches(
E   TypeError: find_fuzzy_matches() got an unexpected keyword argument 'allow_allele_mismatch'
_________ TestFindFuzzyMatches.test_find_fuzzy_matches_strict_alleles __________
tests/test_io_matching.py:359: in test_find_fuzzy_matches_strict_alleles
    matches = find_fuzzy_matches(
E   TypeError: find_fuzzy_matches() got an unexpected keyword argument 'position_tolerance'
_______________ TestMatchVariants.test_match_variants_exact_mode _______________
tests/test_io_matching.py:392: in test_match_variants_exact_mode
    result = match_variants(query, reference, mode="exact")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: match_variants() got an unexpected keyword argument 'mode'
_______________ TestMatchVariants.test_match_variants_fuzzy_mode _______________
tests/test_io_matching.py:417: in test_match_variants_fuzzy_mode
    result = match_variants(query, reference, mode="fuzzy", tolerance=5)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: match_variants() got an unexpected keyword argument 'mode'
______________ TestMatchVariants.test_match_variants_invalid_mode ______________
tests/test_io_matching.py:426: in test_match_variants_invalid_mode
    match_variants(query, reference, mode="invalid")
E   TypeError: match_variants() got an unexpected keyword argument 'mode'
______________ TestMatchVariants.test_match_variants_empty_query _______________
tests/test_io_matching.py:433: in test_match_variants_empty_query
    result = match_variants(query, reference)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/io/matching.py:307: in match_variants
    raise MatchingError(f"Column '{col}' not found in user variants")
          ^^^^^^^^^^^^^
E   NameError: name 'MatchingError' is not defined
____________ TestMatchVariants.test_match_variants_empty_reference _____________
tests/test_io_matching.py:441: in test_match_variants_empty_reference
    result = match_variants(query, reference)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/io/matching.py:309: in match_variants
    raise MatchingError(f"Column '{col}' not found in ClinVar data")
          ^^^^^^^^^^^^^
E   NameError: name 'MatchingError' is not defined
_______________ TestMatchingPerformance.test_match_large_dataset _______________
tests/test_io_matching.py:470: in test_match_large_dataset
    assert len(result) == n_variants // 2
E   assert 0 == (10000 // 2)
E    +  where 0 = len(Empty DataFrame\nColumns: []\nIndex: [])
------------------------------ Captured log call -------------------------------
WARNING  varidex.io.matching:matching.py:85 User DataFrame missing coordinate columns
__________ TestMatchingPerformance.test_match_variants_deduplication ___________
tests/test_io_matching.py:494: in test_match_variants_deduplication
    assert len(result) >= 1
E   assert 0 >= 1
E    +  where 0 = len(Empty DataFrame\nColumns: []\nIndex: [])
------------------------------ Captured log call -------------------------------
WARNING  varidex.io.matching:matching.py:85 User DataFrame missing coordinate columns
_______________ TestMemoryUsage.test_memory_usage_within_limits ________________
tests/test_performance_benchmarks.py:175: in test_memory_usage_within_limits
    processed = [v for v in sample_variants if v.position > 0]
                                               ^^^^^^^^^^^^^^
E   TypeError: '>' not supported between instances of 'str' and 'int'
__________ TestResourceOptimization.test_batch_processing_efficiency ___________
varidex/core/models.py:174: in _validate_position
    pos_int = int(pos_str)
              ^^^^^^^^^^^^
E   ValueError: invalid literal for int() with base 10: 'A'

The above exception was the direct cause of the following exception:
varidex/core/models.py:335: in __init__
    position = _validate_position(position)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:180: in _validate_position
    raise ValidationError(
E   varidex.exceptions.ValidationError: Position must be an integer, got 'A'

The above exception was the direct cause of the following exception:
tests/test_performance_benchmarks.py:327: in test_batch_processing_efficiency
    variants = [Variant("chr1", 10000 + i * 100, "A", "G") for i in range(100)]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Position must be an integer, got 'A'
_________________ TestStageManagement.test_stage_registration __________________
tests/test_pipeline_orchestrator.py:148: in test_stage_registration
    assert hasattr(orchestrator, "_stages") or hasattr(orchestrator, "stages")
E   AssertionError: assert (False or False)
E    +  where False = hasattr(<varidex.pipeline.orchestrator.PipelineOrchestrator object at 0x7d184c105650>, '_stages')
E    +  and   False = hasattr(<varidex.pipeline.orchestrator.PipelineOrchestrator object at 0x7d184c105650>, 'stages')
________________ TestStageManagement.test_stage_execution_order ________________
varidex/pipeline/orchestrator.py:157: in run
    return self._execute_stages(stages)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1169: in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1173: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1234: in _execute_mock_call
    result = effect(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: TestStageManagement.test_stage_execution_order.<locals>.<lambda>() takes 0 positional arguments but 1 was given

During handling of the above exception, another exception occurred:
tests/test_pipeline_orchestrator.py:165: in test_stage_execution_order
    orchestrator.run()
varidex/pipeline/orchestrator.py:162: in run
    raise PipelineError(str(e))
E   varidex.exceptions.PipelineError: TestStageManagement.test_stage_execution_order.<locals>.<lambda>() takes 0 positional arguments but 1 was given
------------------------------ Captured log call -------------------------------
ERROR    varidex.pipeline.orchestrator:orchestrator.py:161 Pipeline execution failed: TestStageManagement.test_stage_execution_order.<locals>.<lambda>() takes 0 positional arguments but 1 was given
_________________ TestStageManagement.test_stage_skip_on_error _________________
varidex/pipeline/orchestrator.py:157: in run
    return self._execute_stages(stages)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1169: in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1173: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1232: in _execute_mock_call
    raise result
E   varidex.exceptions.DataIntegrityError: Stage 1 failed

During handling of the above exception, another exception occurred:
tests/test_pipeline_orchestrator.py:192: in test_stage_skip_on_error
    orchestrator.run()
varidex/pipeline/orchestrator.py:162: in run
    raise PipelineError(str(e))
E   varidex.exceptions.PipelineError: Stage 1 failed
------------------------------ Captured log call -------------------------------
ERROR    varidex.pipeline.orchestrator:orchestrator.py:161 Pipeline execution failed: Stage 1 failed
_______________ TestErrorHandling.test_validation_error_handling _______________
varidex/pipeline/orchestrator.py:157: in run
    return self._execute_stages(stages)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1169: in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1173: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1228: in _execute_mock_call
    raise effect
E   varidex.exceptions.ValidationError: Invalid input

During handling of the above exception, another exception occurred:
tests/test_pipeline_orchestrator.py:289: in test_validation_error_handling
    orchestrator.run()
varidex/pipeline/orchestrator.py:162: in run
    raise PipelineError(str(e))
E   varidex.exceptions.PipelineError: Invalid input
------------------------------ Captured log call -------------------------------
ERROR    varidex.pipeline.orchestrator:orchestrator.py:161 Pipeline execution failed: Invalid input
____________ TestErrorHandling.test_data_processing_error_handling _____________
varidex/pipeline/orchestrator.py:157: in run
    return self._execute_stages(stages)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1169: in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1173: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1228: in _execute_mock_call
    raise effect
E   varidex.exceptions.DataIntegrityError: Processing failed

During handling of the above exception, another exception occurred:
tests/test_pipeline_orchestrator.py:297: in test_data_processing_error_handling
    orchestrator.run()
varidex/pipeline/orchestrator.py:162: in run
    raise PipelineError(str(e))
E   varidex.exceptions.PipelineError: Processing failed
------------------------------ Captured log call -------------------------------
ERROR    varidex.pipeline.orchestrator:orchestrator.py:161 Pipeline execution failed: Processing failed
________________ TestErrorHandling.test_continue_on_error_mode _________________
varidex/pipeline/orchestrator.py:157: in run
    return self._execute_stages(stages)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1169: in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1173: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1232: in _execute_mock_call
    raise result
E   varidex.exceptions.DataIntegrityError: Non-critical error

During handling of the above exception, another exception occurred:
tests/test_pipeline_orchestrator.py:311: in test_continue_on_error_mode
    result = orchestrator.run()
             ^^^^^^^^^^^^^^^^^^
varidex/pipeline/orchestrator.py:162: in run
    raise PipelineError(str(e))
E   varidex.exceptions.PipelineError: Non-critical error
------------------------------ Captured log call -------------------------------
ERROR    varidex.pipeline.orchestrator:orchestrator.py:161 Pipeline execution failed: Non-critical error
______________ TestValidationStage.test_validate_vcf_format_valid ______________
tests/test_pipeline_stages.py:62: in test_validate_vcf_format_valid
    result = validation_stage.validate_vcf_format(valid_vcf)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ValidationStage' object has no attribute 'validate_vcf_format'
_____________ TestValidationStage.test_validate_vcf_format_invalid _____________
tests/test_pipeline_stages.py:68: in test_validate_vcf_format_invalid
    validation_stage.validate_vcf_format(invalid_vcf)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ValidationStage' object has no attribute 'validate_vcf_format'
__________ TestValidationStage.test_validate_vcf_format_missing_file ___________
tests/test_pipeline_stages.py:74: in test_validate_vcf_format_missing_file
    validation_stage.validate_vcf_format(missing_file)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ValidationStage' object has no attribute 'validate_vcf_format'
______________ TestValidationStage.test_validate_reference_genome ______________
tests/test_pipeline_stages.py:78: in test_validate_reference_genome
    assert validation_stage.validate_reference_genome("GRCh38") is True
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ValidationStage' object has no attribute 'validate_reference_genome'
______________ TestValidationStage.test_validate_chromosome_names ______________
tests/test_pipeline_stages.py:88: in test_validate_chromosome_names
    assert validation_stage.validate_chromosome(chrom) is True
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ValidationStage' object has no attribute 'validate_chromosome'
_________________ TestValidationStage.test_validate_positions __________________
tests/test_pipeline_stages.py:92: in test_validate_positions
    assert validation_stage.validate_position(12345) is True
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ValidationStage' object has no attribute 'validate_position'
__________________ TestValidationStage.test_validate_alleles ___________________
tests/test_pipeline_stages.py:102: in test_validate_alleles
    assert validation_stage.validate_alleles("A", "G") is True
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ValidationStage' object has no attribute 'validate_alleles'
______________ TestValidationStage.test_execute_validation_stage _______________
tests/test_pipeline_stages.py:112: in test_execute_validation_stage
    validation_stage.config.input_vcf = valid_vcf
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ValidationStage' object has no attribute 'config'
________________ TestAnnotationStage.test_annotate_with_gnomad _________________
tests/test_pipeline_stages.py:151: in test_annotate_with_gnomad
    with patch.object(annotation_stage, "_fetch_gnomad_data") as mock_gnomad:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <varidex.pipeline.stages.AnnotationStage object at 0x7d184e1fb0e0> does not have the attribute '_fetch_gnomad_data'
________________ TestAnnotationStage.test_annotate_with_clinvar ________________
tests/test_pipeline_stages.py:163: in test_annotate_with_clinvar
    with patch.object(annotation_stage, "_fetch_clinvar_data") as mock_clinvar:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <varidex.pipeline.stages.AnnotationStage object at 0x7d184dd2a710> does not have the attribute '_fetch_clinvar_data'
________________ TestAnnotationStage.test_annotate_with_dbnsfp _________________
tests/test_pipeline_stages.py:175: in test_annotate_with_dbnsfp
    with patch.object(annotation_stage, "_fetch_dbnsfp_data") as mock_dbnsfp:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <varidex.pipeline.stages.AnnotationStage object at 0x7d184dd2a5d0> does not have the attribute '_fetch_dbnsfp_data'
______________ TestAnnotationStage.test_annotate_multiple_sources ______________
tests/test_pipeline_stages.py:187: in test_annotate_multiple_sources
    with patch.object(annotation_stage, "_fetch_gnomad_data") as mock_gnomad:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <varidex.pipeline.stages.AnnotationStage object at 0x7d184ddd2520> does not have the attribute '_fetch_gnomad_data'
___________ TestAnnotationStage.test_annotation_handles_missing_data ___________
tests/test_pipeline_stages.py:202: in test_annotation_handles_missing_data
    with patch.object(annotation_stage, "_fetch_gnomad_data") as mock_gnomad:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <varidex.pipeline.stages.AnnotationStage object at 0x7d184ddd2b10> does not have the attribute '_fetch_gnomad_data'
__________________ TestAnnotationStage.test_batch_annotation ___________________
tests/test_pipeline_stages.py:213: in test_batch_annotation
    with patch.object(annotation_stage, "annotate_variant") as mock_annotate:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <varidex.pipeline.stages.AnnotationStage object at 0x7d184dd15fd0> does not have the attribute 'annotate_variant'
______________ TestAnnotationStage.test_execute_annotation_stage _______________
tests/test_pipeline_stages.py:223: in test_execute_annotation_stage
    with patch.object(annotation_stage, "_load_variants") as mock_load:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <varidex.pipeline.stages.AnnotationStage object at 0x7d184e14a9c0> does not have the attribute '_load_variants'
__________________ TestFilteringStage.test_filter_by_quality ___________________
tests/test_pipeline_stages.py:266: in test_filter_by_quality
    filtered = filtering_stage.filter_by_quality(annotated_variants, min_quality=20)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'FilteringStage' object has no attribute 'filter_by_quality'
_________________ TestFilteringStage.test_filter_by_frequency __________________
tests/test_pipeline_stages.py:273: in test_filter_by_frequency
    filtered = filtering_stage.filter_by_frequency(annotated_variants, max_af=0.05)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'FilteringStage' object has no attribute 'filter_by_frequency'
___________________ TestFilteringStage.test_filter_by_region ___________________
tests/test_pipeline_stages.py:280: in test_filter_by_region
    filtered = filtering_stage.filter_by_region(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'FilteringStage' object has no attribute 'filter_by_region'
____________________ TestFilteringStage.test_filter_by_gene ____________________
tests/test_pipeline_stages.py:291: in test_filter_by_gene
    annotated_variants[0].annotations["gene"] = "BRCA1"
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'VariantData' object has no attribute 'annotations'
___________________ TestFilteringStage.test_filter_by_impact ___________________
tests/test_pipeline_stages.py:301: in test_filter_by_impact
    annotated_variants[0].annotations["impact"] = "HIGH"
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'VariantData' object has no attribute 'annotations'
__________________ TestFilteringStage.test_compound_filtering __________________
tests/test_pipeline_stages.py:313: in test_compound_filtering
    filtered = filtering_stage.apply_filters(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'FilteringStage' object has no attribute 'apply_filters'
_______________ TestFilteringStage.test_execute_filtering_stage ________________
tests/test_pipeline_stages.py:323: in test_execute_filtering_stage
    with patch.object(filtering_stage, "_load_variants") as mock_load:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <varidex.pipeline.stages.FilteringStage object at 0x7d184dd2b750> does not have the attribute '_load_variants'
____________________ TestOutputStage.test_write_vcf_output _____________________
tests/test_pipeline_stages.py:360: in test_write_vcf_output
    output_stage.write_vcf(processed_variants, output_file)
    ^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'OutputStage' object has no attribute 'write_vcf'
____________________ TestOutputStage.test_write_tsv_output _____________________
tests/test_pipeline_stages.py:369: in test_write_tsv_output
    output_stage.write_tsv(processed_variants, output_file)
    ^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'OutputStage' object has no attribute 'write_tsv'
____________________ TestOutputStage.test_write_json_output ____________________
tests/test_pipeline_stages.py:378: in test_write_json_output
    output_stage.write_json(processed_variants, output_file)
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'OutputStage' object has no attribute 'write_json'
____________________ TestOutputStage.test_write_html_report ____________________
tests/test_pipeline_stages.py:389: in test_write_html_report
    output_stage.write_html_report(processed_variants, output_file)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'OutputStage' object has no attribute 'write_html_report'
________________ TestOutputStage.test_write_summary_statistics _________________
tests/test_pipeline_stages.py:398: in test_write_summary_statistics
    output_stage.write_summary(processed_variants, output_file)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'OutputStage' object has no attribute 'write_summary'
__________________ TestOutputStage.test_execute_output_stage ___________________
tests/test_pipeline_stages.py:406: in test_execute_output_stage
    with patch.object(output_stage, "_load_variants") as mock_load:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <varidex.pipeline.stages.OutputStage object at 0x7d184dd2b890> does not have the attribute '_load_variants'
_____________ TestStageDataFlow.test_validation_to_annotation_flow _____________
varidex/core/models.py:174: in _validate_position
    pos_int = int(pos_str)
              ^^^^^^^^^^^^
E   ValueError: invalid literal for int() with base 10: 'A'

The above exception was the direct cause of the following exception:
varidex/core/models.py:335: in __init__
    position = _validate_position(position)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:180: in _validate_position
    raise ValidationError(
E   varidex.exceptions.ValidationError: Position must be an integer, got 'A'

The above exception was the direct cause of the following exception:
tests/test_pipeline_stages.py:430: in test_validation_to_annotation_flow
    validated_data = [Variant("chr1", 12345, "A", "G")]
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Position must be an integer, got 'A'
_____________ TestStageDataFlow.test_annotation_to_filtering_flow ______________
varidex/core/models.py:174: in _validate_position
    pos_int = int(pos_str)
              ^^^^^^^^^^^^
E   ValueError: invalid literal for int() with base 10: 'A'

The above exception was the direct cause of the following exception:
varidex/core/models.py:335: in __init__
    position = _validate_position(position)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:180: in _validate_position
    raise ValidationError(
E   varidex.exceptions.ValidationError: Position must be an integer, got 'A'

The above exception was the direct cause of the following exception:
tests/test_pipeline_stages.py:451: in test_annotation_to_filtering_flow
    annotated_data = [Variant("chr1", 12345, "A", "G", annotations={"af": 0.001})]
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Position must be an integer, got 'A'
__________ TestValidateVariant.test_validate_variant_invalid_position __________
varidex/core/models.py:335: in __init__
    position = _validate_position(position)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:176: in _validate_position
    raise ValidationError(f"Position must be positive, got {pos_int}")
E   varidex.exceptions.ValidationError: Position must be positive, got -100

The above exception was the direct cause of the following exception:
tests/test_pipeline_validators.py:184: in test_validate_variant_invalid_position
    variant = GenomicVariant(
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Position must be positive, got -100
_________ TestValidateVariant.test_validate_variant_invalid_reference __________
varidex/core/models.py:336: in __init__
    ref_allele = _validate_allele(
varidex/core/models.py:223: in _validate_allele
    raise ValidationError(
E   varidex.exceptions.ValidationError: Invalid reference allele 'X'. Must contain only nucleotides A, C, G, T, or N

The above exception was the direct cause of the following exception:
tests/test_pipeline_validators.py:195: in test_validate_variant_invalid_reference
    variant = GenomicVariant(
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Invalid reference allele 'X'. Must contain only nucleotides A, C, G, T, or N
_________ TestValidationEdgeCases.test_validate_variant_missing_fields _________
varidex/core/models.py:336: in __init__
    ref_allele = _validate_allele(
varidex/core/models.py:215: in _validate_allele
    raise ValidationError(f"{allele_type.capitalize()} cannot be empty")
E   varidex.exceptions.ValidationError: Reference allele cannot be empty

The above exception was the direct cause of the following exception:
tests/test_pipeline_validators.py:306: in test_validate_variant_missing_fields
    variant = GenomicVariant(
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Reference allele cannot be empty
____________ TestValidationPerformance.test_validate_mixed_validity ____________
varidex/core/models.py:335: in __init__
    position = _validate_position(position)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
varidex/core/models.py:176: in _validate_position
    raise ValidationError(f"Position must be positive, got {pos_int}")
E   varidex.exceptions.ValidationError: Position must be positive, got -1

The above exception was the direct cause of the following exception:
tests/test_pipeline_validators.py:364: in test_validate_mixed_validity
    GenomicVariant(
varidex/core/models.py:349: in __init__
    raise ValidationError(f"Invalid variant data: {e}") from e
E   varidex.exceptions.ValidationError: Invalid variant data: Position must be positive, got -1
________________ TestReportGenerator.test_generate_html_report _________________
tests/test_reports_generator.py:68: in test_generate_html_report
    generator.generate_html_report(sample_variants, output_file)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ReportGenerator' object has no attribute 'generate_html_report'. Did you mean: 'generate_reports'?
_____________ TestReportGenerator.test_generate_summary_statistics _____________
tests/test_reports_generator.py:77: in test_generate_summary_statistics
    summary = generator.generate_summary(sample_variants)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ReportGenerator' object has no attribute 'generate_summary'
________________ TestReportGenerator.test_generate_json_report _________________
tests/test_reports_generator.py:86: in test_generate_json_report
    generator.generate_json_report(sample_variants, output_file)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ReportGenerator' object has no attribute 'generate_json_report'. Did you mean: 'generate_reports'?
_________________ TestReportGenerator.test_generate_tsv_report _________________
tests/test_reports_generator.py:95: in test_generate_tsv_report
    generator.generate_tsv_report(sample_variants, output_file)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ReportGenerator' object has no attribute 'generate_tsv_report'. Did you mean: 'generate_reports'?
______________ TestReportGenerator.test_generate_with_empty_data _______________
tests/test_reports_generator.py:105: in test_generate_with_empty_data
    generator.generate_html_report([], output_file)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ReportGenerator' object has no attribute 'generate_html_report'. Did you mean: 'generate_reports'?
__________ TestReportGenerator.test_generate_with_invalid_output_path __________
tests/test_reports_generator.py:116: in test_generate_with_invalid_output_path
    generator.generate_html_report(sample_variants, invalid_path)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ReportGenerator' object has no attribute 'generate_html_report'. Did you mean: 'generate_reports'?
_________________ TestHTMLFormatter.test_format_variant_table __________________
tests/test_reports_generator.py:144: in test_format_variant_table
    html = formatter.format_variant_table(sample_data["variants"])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'HTMLFormatter' object has no attribute 'format_variant_table'
________________ TestHTMLFormatter.test_format_summary_section _________________
tests/test_reports_generator.py:152: in test_format_summary_section
    html = formatter.format_summary(sample_data["summary"])
           ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'HTMLFormatter' object has no attribute 'format_summary'
________________ TestHTMLFormatter.test_format_complete_report _________________
tests/test_reports_generator.py:159: in test_format_complete_report
    html = formatter.format_report(sample_data)
           ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'HTMLFormatter' object has no attribute 'format_report'
______________ TestHTMLFormatter.test_format_with_custom_template ______________
tests/test_reports_generator.py:168: in test_format_with_custom_template
    html = formatter.format_with_template(sample_data, template=custom_template)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'HTMLFormatter' object has no attribute 'format_with_template'
________________ TestHTMLFormatter.test_escape_html_characters _________________
tests/test_reports_generator.py:176: in test_escape_html_characters
    safe_output = formatter.escape(dangerous_input)
                  ^^^^^^^^^^^^^^^^
E   AttributeError: 'HTMLFormatter' object has no attribute 'escape'
_______________ TestHTMLFormatter.test_format_with_missing_data ________________
tests/test_reports_generator.py:184: in test_format_with_missing_data
    html = formatter.format_report(incomplete_data)
           ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'HTMLFormatter' object has no attribute 'format_report'
________________ TestJSONFormatter.test_format_variants_to_json ________________
tests/test_reports_generator.py:217: in test_format_variants_to_json
    assert data[0]["chromosome"] == "chr1"
           ^^^^^^^^^^^^^^^^^^^^^
E   TypeError: string indices must be integers, not 'str'
_______________ TestJSONFormatter.test_format_with_pretty_print ________________
tests/test_reports_generator.py:221: in test_format_with_pretty_print
    json_str = formatter.format(sample_variants, indent=2)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: JSONFormatter.format() got an unexpected keyword argument 'indent'
_______________ TestJSONFormatter.test_format_nested_annotations _______________
tests/test_reports_generator.py:253: in test_format_nested_annotations
    assert "annotations" in data[0]
E   AssertionError: assert 'annotations' in 'Variant( in :  ->  [No evidence])'
_________________ TestTSVFormatter.test_format_variants_to_tsv _________________
tests/test_reports_generator.py:288: in test_format_variants_to_tsv
    assert "\t" in tsv_str
E   AssertionError: assert '\t' in ''
_____________________ TestTSVFormatter.test_tsv_header_row _____________________
tests/test_reports_generator.py:298: in test_tsv_header_row
    assert "chromosome" in header.lower() or "chrom" in header.lower()
E   AssertionError: assert ('chromosome' in '' or 'chrom' in '')
E    +  where '' = <built-in method lower of str object at 0xa59de8>()
E    +    where <built-in method lower of str object at 0xa59de8> = ''.lower
E    +  and   '' = <built-in method lower of str object at 0xa59de8>()
E    +    where <built-in method lower of str object at 0xa59de8> = ''.lower
_____________________ TestTSVFormatter.test_tsv_data_rows ______________________
tests/test_reports_generator.py:306: in test_tsv_data_rows
    assert len(lines) >= 3  # Header + 2 data rows + possible empty
    ^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: assert 1 >= 3
E    +  where 1 = len([''])
______________ TestTSVFormatter.test_tsv_with_missing_annotations ______________
tests/test_reports_generator.py:317: in test_tsv_with_missing_annotations
    assert "chr1" in tsv_str
E   AssertionError: assert 'chr1' in ''
_____________ TestReportStatistics.test_statistics_with_empty_list _____________
tests/test_reports_generator.py:405: in test_statistics_with_empty_list
    stats = generator.generate_summary([])
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ReportGenerator' object has no attribute 'generate_summary'
_______________ TestParseVariantKey.test_parse_variant_key_none ________________
tests/test_utils_helpers.py:188: in test_parse_variant_key_none
    with pytest.raises((TypeError, AttributeError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (<class 'TypeError'>, <class 'AttributeError'>)
=============================== warnings summary ===============================
tests/test_dbnsfp_integration.py:15
  /media/michal/647A504F7A50205A/GENOME/Michal/VariDex10/VariDex/tests/test_dbnsfp_integration.py:15: UserWarning: ACMGClassifierV7 is EXPERIMENTAL and not production-tested. Use ACMGClassifier for production. See VERSION_HISTORY.md for details.
    from varidex.core.classifier.engine_v8 import ACMGClassifierV8

tests/test_dbnsfp_integration.py:15
  /media/michal/647A504F7A50205A/GENOME/Michal/VariDex10/VariDex/tests/test_dbnsfp_integration.py:15: UserWarning: ACMGClassifierV8 is EXPERIMENTAL and not production-tested. Use ACMGClassifier for production. See VERSION_HISTORY.md for details.
    from varidex.core.classifier.engine_v8 import ACMGClassifierV8

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/reporting/test_cli.py::TestReportingCLI::test_single_format[--html]
FAILED tests/reporting/test_cli.py::TestReportingCLI::test_single_format[--tsv]
FAILED tests/reporting/test_cli.py::TestReportingCLI::test_single_format[--json]
FAILED tests/reporting/test_cli.py::TestReportingCLI::test_single_format[--qc]
FAILED tests/test_cli_interface.py::TestCLIArguments::test_cli_help_flag - Fa...
FAILED tests/test_cli_interface.py::TestCLIArguments::test_cli_version_flag
FAILED tests/test_cli_interface.py::TestCLIArguments::test_cli_required_args
FAILED tests/test_cli_interface.py::TestCLIFileValidation::test_cli_input_file_permissions
FAILED tests/test_cli_interface.py::TestCLIExecution::test_cli_verbose_mode
FAILED tests/test_cli_interface.py::TestCLIErrorHandling::test_cli_missing_input_error
FAILED tests/test_cli_interface.py::TestCLIErrorHandling::test_cli_invalid_format_error
FAILED tests/test_cli_interface.py::TestCLIErrorHandling::test_cli_permission_error
FAILED tests/test_cli_interface.py::TestCLIErrorHandling::test_cli_interrupt_handling
FAILED tests/test_cli_interface.py::TestCLIOutputFormats::test_cli_csv_output
FAILED tests/test_cli_interface.py::TestCLIOutputFormats::test_cli_json_output
FAILED tests/test_cli_interface.py::TestCLIOutputFormats::test_cli_vcf_output
FAILED tests/test_cli_interface.py::TestCLIOutputFormats::test_cli_auto_format_detection
FAILED tests/test_cli_interface.py::TestCLIConfigurationOptions::test_cli_config_file_loading
FAILED tests/test_cli_interface.py::TestCLIConfigurationOptions::test_cli_invalid_config_file
FAILED tests/test_cli_interface.py::TestCLIProgressReporting::test_cli_progress_bar
FAILED tests/test_cli_interface.py::TestCLIProgressReporting::test_cli_log_file_creation
FAILED tests/test_cli_interface.py::TestCLIProgressReporting::test_cli_log_level
FAILED tests/test_core_models.py::TestVariantCreation::test_full_variant_creation
FAILED tests/test_core_models.py::TestVariantCreation::test_variant_with_optional_fields
FAILED tests/test_core_models.py::TestVariantValidation::test_invalid_chromosome
FAILED tests/test_core_models.py::TestVariantValidation::test_negative_position
FAILED tests/test_core_models.py::TestVariantValidation::test_zero_position
FAILED tests/test_core_models.py::TestVariantValidation::test_empty_ref_allele
FAILED tests/test_core_models.py::TestVariantValidation::test_empty_alt_allele
FAILED tests/test_core_models.py::TestVariantValidation::test_invalid_nucleotides
FAILED tests/test_core_models.py::TestVariantIdentifier::test_variant_id_generation
FAILED tests/test_core_models.py::TestVariantSerialization::test_round_trip_serialization
FAILED tests/test_core_models.py::TestVariantClassification::test_confidence_range
FAILED tests/test_core_models.py::TestAnnotatedVariant::test_annotated_variant_creation
FAILED tests/test_core_models.py::TestAnnotatedVariant::test_gnomad_af_range
FAILED tests/test_core_models.py::TestAnnotatedVariant::test_cadd_score_range
FAILED tests/test_coverage_boost_integration_paths.py::TestFileReadingEdgeCases::test_very_large_file_size
FAILED tests/test_coverage_boost_validation.py::TestChromosomeValidation::test_invalid_chromosome_names
FAILED tests/test_coverage_boost_validation.py::TestChromosomeValidation::test_chromosome_with_special_characters
FAILED tests/test_coverage_boost_validation.py::TestPositionValidation::test_position_string_rejected
FAILED tests/test_coverage_gaps.py::TestDownloaderCoverage::test_download_with_invalid_url
FAILED tests/test_coverage_gaps.py::TestDownloaderCoverage::test_download_with_timeout
FAILED tests/test_data_validation.py::TestVariantDataValidation::test_invalid_positions
FAILED tests/test_data_validation.py::TestFrequencyValidation::test_valid_frequencies
FAILED tests/test_data_validation.py::TestDataFrameValidation::test_duplicate_variants
FAILED tests/test_data_validation.py::TestBoundaryConditions::test_max_chromosome_length
FAILED tests/test_data_validation.py::TestBoundaryConditions::test_extreme_float_values
FAILED tests/test_downloader.py::TestDownloadFile::test_download_file_success
FAILED tests/test_downloader.py::TestDownloadFile::test_download_file_http_error
FAILED tests/test_downloader.py::TestDownloadFile::test_download_file_with_progress
FAILED tests/test_downloader.py::TestDownloadFile::test_download_file_network_error
FAILED tests/test_downloader.py::TestResourceDownloader::test_init_default_cache_dir
FAILED tests/test_downloader.py::TestResourceDownloader::test_init_custom_cache_dir
FAILED tests/test_downloader.py::TestResourceDownloader::test_download_resource_not_cached
FAILED tests/test_downloader.py::TestResourceDownloader::test_download_resource_already_cached
FAILED tests/test_downloader.py::TestResourceDownloader::test_download_resource_with_checksum
FAILED tests/test_downloader.py::TestResourceDownloader::test_download_resource_checksum_mismatch
FAILED tests/test_downloader.py::TestResourceDownloader::test_download_resource_force_redownload
FAILED tests/test_downloader.py::TestResourceDownloader::test_clear_cache - T...
FAILED tests/test_downloader.py::TestResourceDownloader::test_get_cache_size
FAILED tests/test_downloader.py::TestResourceDownloader::test_list_cached_files
FAILED tests/test_downloader.py::TestDownloadRetry::test_download_retry_success_on_second_attempt
FAILED tests/test_downloader.py::TestDownloadRetry::test_download_retry_exhausted
FAILED tests/test_edge_cases.py::TestMalformedData::test_mixed_type_chromosome
FAILED tests/test_edge_cases.py::TestDataTypeConversions::test_string_to_numeric_conversion
FAILED tests/test_edge_cases.py::TestDataTypeConversions::test_numeric_to_string_conversion
FAILED tests/test_error_recovery.py::TestDataValidationErrors::test_invalid_position_format
FAILED tests/test_integration_e2e.py::TestEndToEndPipeline::test_e2e_single_variant_annotation
FAILED tests/test_integration_e2e.py::TestEndToEndPipeline::test_e2e_variant_matching_workflow
FAILED tests/test_integration_e2e.py::TestEndToEndPipeline::test_e2e_multi_source_integration
FAILED tests/test_integration_e2e.py::TestPerformanceIntegration::test_large_vcf_processing
FAILED tests/test_integration_e2e.py::TestPerformanceIntegration::test_concurrent_matching_performance
FAILED tests/test_integration_e2e.py::TestPerformanceIntegration::test_memory_efficient_processing
FAILED tests/test_integration_e2e.py::TestDataIntegrity::test_roundtrip_vcf_to_dataframe
FAILED tests/test_integration_e2e.py::TestDataIntegrity::test_coordinate_system_consistency
FAILED tests/test_integration_e2e.py::TestDataIntegrity::test_allele_normalization_integrity
FAILED tests/test_integration_e2e.py::TestErrorRecovery::test_pipeline_handles_malformed_input
FAILED tests/test_integration_e2e.py::TestErrorRecovery::test_pipeline_handles_missing_files
FAILED tests/test_integration_e2e.py::TestConfigurationIntegration::test_config_affects_pipeline_behavior
FAILED tests/test_integration_e2e.py::TestConfigurationIntegration::test_config_persistence
FAILED tests/test_io_matching.py::TestMatchByCoordinates::test_match_by_coordinates_exact
FAILED tests/test_io_matching.py::TestMatchByCoordinates::test_match_by_coordinates_partial_overlap
FAILED tests/test_io_matching.py::TestMatchByCoordinates::test_match_by_coordinates_allow_mismatch
FAILED tests/test_io_matching.py::TestMatchByVariantID::test_match_by_variant_id_rsid
FAILED tests/test_io_matching.py::TestMatchByVariantID::test_match_by_variant_id_no_matches
FAILED tests/test_io_matching.py::TestFindExactMatches::test_find_exact_matches_basic
FAILED tests/test_io_matching.py::TestFindExactMatches::test_find_exact_matches_none
FAILED tests/test_io_matching.py::TestFindExactMatches::test_find_exact_matches_assembly_mismatch
FAILED tests/test_io_matching.py::TestFindFuzzyMatches::test_find_fuzzy_matches_nearby_position
FAILED tests/test_io_matching.py::TestFindFuzzyMatches::test_find_fuzzy_matches_different_alleles
FAILED tests/test_io_matching.py::TestFindFuzzyMatches::test_find_fuzzy_matches_strict_alleles
FAILED tests/test_io_matching.py::TestMatchVariants::test_match_variants_exact_mode
FAILED tests/test_io_matching.py::TestMatchVariants::test_match_variants_fuzzy_mode
FAILED tests/test_io_matching.py::TestMatchVariants::test_match_variants_invalid_mode
FAILED tests/test_io_matching.py::TestMatchVariants::test_match_variants_empty_query
FAILED tests/test_io_matching.py::TestMatchVariants::test_match_variants_empty_reference
FAILED tests/test_io_matching.py::TestMatchingPerformance::test_match_large_dataset
FAILED tests/test_io_matching.py::TestMatchingPerformance::test_match_variants_deduplication
FAILED tests/test_performance_benchmarks.py::TestMemoryUsage::test_memory_usage_within_limits
FAILED tests/test_performance_benchmarks.py::TestResourceOptimization::test_batch_processing_efficiency
FAILED tests/test_pipeline_orchestrator.py::TestStageManagement::test_stage_registration
FAILED tests/test_pipeline_orchestrator.py::TestStageManagement::test_stage_execution_order
FAILED tests/test_pipeline_orchestrator.py::TestStageManagement::test_stage_skip_on_error
FAILED tests/test_pipeline_orchestrator.py::TestErrorHandling::test_validation_error_handling
FAILED tests/test_pipeline_orchestrator.py::TestErrorHandling::test_data_processing_error_handling
FAILED tests/test_pipeline_orchestrator.py::TestErrorHandling::test_continue_on_error_mode
FAILED tests/test_pipeline_stages.py::TestValidationStage::test_validate_vcf_format_valid
FAILED tests/test_pipeline_stages.py::TestValidationStage::test_validate_vcf_format_invalid
FAILED tests/test_pipeline_stages.py::TestValidationStage::test_validate_vcf_format_missing_file
FAILED tests/test_pipeline_stages.py::TestValidationStage::test_validate_reference_genome
FAILED tests/test_pipeline_stages.py::TestValidationStage::test_validate_chromosome_names
FAILED tests/test_pipeline_stages.py::TestValidationStage::test_validate_positions
FAILED tests/test_pipeline_stages.py::TestValidationStage::test_validate_alleles
FAILED tests/test_pipeline_stages.py::TestValidationStage::test_execute_validation_stage
FAILED tests/test_pipeline_stages.py::TestAnnotationStage::test_annotate_with_gnomad
FAILED tests/test_pipeline_stages.py::TestAnnotationStage::test_annotate_with_clinvar
FAILED tests/test_pipeline_stages.py::TestAnnotationStage::test_annotate_with_dbnsfp
FAILED tests/test_pipeline_stages.py::TestAnnotationStage::test_annotate_multiple_sources
FAILED tests/test_pipeline_stages.py::TestAnnotationStage::test_annotation_handles_missing_data
FAILED tests/test_pipeline_stages.py::TestAnnotationStage::test_batch_annotation
FAILED tests/test_pipeline_stages.py::TestAnnotationStage::test_execute_annotation_stage
FAILED tests/test_pipeline_stages.py::TestFilteringStage::test_filter_by_quality
FAILED tests/test_pipeline_stages.py::TestFilteringStage::test_filter_by_frequency
FAILED tests/test_pipeline_stages.py::TestFilteringStage::test_filter_by_region
FAILED tests/test_pipeline_stages.py::TestFilteringStage::test_filter_by_gene
FAILED tests/test_pipeline_stages.py::TestFilteringStage::test_filter_by_impact
FAILED tests/test_pipeline_stages.py::TestFilteringStage::test_compound_filtering
FAILED tests/test_pipeline_stages.py::TestFilteringStage::test_execute_filtering_stage
FAILED tests/test_pipeline_stages.py::TestOutputStage::test_write_vcf_output
FAILED tests/test_pipeline_stages.py::TestOutputStage::test_write_tsv_output
FAILED tests/test_pipeline_stages.py::TestOutputStage::test_write_json_output
FAILED tests/test_pipeline_stages.py::TestOutputStage::test_write_html_report
FAILED tests/test_pipeline_stages.py::TestOutputStage::test_write_summary_statistics
FAILED tests/test_pipeline_stages.py::TestOutputStage::test_execute_output_stage
FAILED tests/test_pipeline_stages.py::TestStageDataFlow::test_validation_to_annotation_flow
FAILED tests/test_pipeline_stages.py::TestStageDataFlow::test_annotation_to_filtering_flow
FAILED tests/test_pipeline_validators.py::TestValidateVariant::test_validate_variant_invalid_position
FAILED tests/test_pipeline_validators.py::TestValidateVariant::test_validate_variant_invalid_reference
FAILED tests/test_pipeline_validators.py::TestValidationEdgeCases::test_validate_variant_missing_fields
FAILED tests/test_pipeline_validators.py::TestValidationPerformance::test_validate_mixed_validity
FAILED tests/test_reports_generator.py::TestReportGenerator::test_generate_html_report
FAILED tests/test_reports_generator.py::TestReportGenerator::test_generate_summary_statistics
FAILED tests/test_reports_generator.py::TestReportGenerator::test_generate_json_report
FAILED tests/test_reports_generator.py::TestReportGenerator::test_generate_tsv_report
FAILED tests/test_reports_generator.py::TestReportGenerator::test_generate_with_empty_data
FAILED tests/test_reports_generator.py::TestReportGenerator::test_generate_with_invalid_output_path
FAILED tests/test_reports_generator.py::TestHTMLFormatter::test_format_variant_table
FAILED tests/test_reports_generator.py::TestHTMLFormatter::test_format_summary_section
FAILED tests/test_reports_generator.py::TestHTMLFormatter::test_format_complete_report
FAILED tests/test_reports_generator.py::TestHTMLFormatter::test_format_with_custom_template
FAILED tests/test_reports_generator.py::TestHTMLFormatter::test_escape_html_characters
FAILED tests/test_reports_generator.py::TestHTMLFormatter::test_format_with_missing_data
FAILED tests/test_reports_generator.py::TestJSONFormatter::test_format_variants_to_json
FAILED tests/test_reports_generator.py::TestJSONFormatter::test_format_with_pretty_print
FAILED tests/test_reports_generator.py::TestJSONFormatter::test_format_nested_annotations
FAILED tests/test_reports_generator.py::TestTSVFormatter::test_format_variants_to_tsv
FAILED tests/test_reports_generator.py::TestTSVFormatter::test_tsv_header_row
FAILED tests/test_reports_generator.py::TestTSVFormatter::test_tsv_data_rows
FAILED tests/test_reports_generator.py::TestTSVFormatter::test_tsv_with_missing_annotations
FAILED tests/test_reports_generator.py::TestReportStatistics::test_statistics_with_empty_list
FAILED tests/test_utils_helpers.py::TestParseVariantKey::test_parse_variant_key_none
ERROR tests/test_reports_generator.py::TestReportStatistics::test_count_by_chromosome
ERROR tests/test_reports_generator.py::TestReportStatistics::test_count_by_impact
ERROR tests/test_reports_generator.py::TestReportStatistics::test_count_by_gene
ERROR tests/test_reports_generator.py::TestReportStatistics::test_total_variant_count
====== 161 failed, 742 passed, 14 skipped, 2 warnings, 4 errors in 4.17s =======
